#!/bin/sh

FULLVER="$1"

case $FULLVER in
  2.10.2)
    VER=2.10
    ;;
  2.10.3)
    VER=2.10
    ;;
  2.10.4-RC2)
    VER=2.10
    ;;
  2.11.0-M7)
    VER=2.11.0-M7
    ;;
  2.11.0-M8)
    VER=2.11.0-M8
    ;;
esac

REVERSI_EXTDEPS_SIZE=$(stat '-c%s' examples/reversi/target/scala-$VER/reversi-extdeps.js)
REVERSI_SELF_SIZE=$(stat '-c%s' examples/reversi/target/scala-$VER/reversi.js)
REVERSI_OPT_SIZE=$(stat '-c%s' examples/reversi/target/scala-$VER/reversi-opt.js)
echo "Reversi extdeps size = $REVERSI_EXTDEPS_SIZE"
echo "Reversi self size = $REVERSI_SELF_SIZE"
echo "Reversi opt size = $REVERSI_OPT_SIZE"
case $FULLVER in
  2.10.2)
    REVERSI_EXTDEPS_EXPECTEDSIZE=23500000
    REVERSI_SELF_EXPECTEDSIZE=95000
    REVERSI_OPT_EXPECTEDSIZE=285000
    ;;
  2.10.3)
    REVERSI_EXTDEPS_EXPECTEDSIZE=22800000
    REVERSI_SELF_EXPECTEDSIZE=75000
    REVERSI_OPT_EXPECTEDSIZE=275000
    ;;
  2.10.4-RC2)
    REVERSI_EXTDEPS_EXPECTEDSIZE=22800000
    REVERSI_SELF_EXPECTEDSIZE=75000
    REVERSI_OPT_EXPECTEDSIZE=275000
    ;;
  2.11.0-M7)
    REVERSI_EXTDEPS_EXPECTEDSIZE=20500000
    REVERSI_SELF_EXPECTEDSIZE=76000
    REVERSI_OPT_EXPECTEDSIZE=275000
    ;;
  2.11.0-M8)
    REVERSI_EXTDEPS_EXPECTEDSIZE=20400000
    REVERSI_SELF_EXPECTEDSIZE=70000
    REVERSI_OPT_EXPECTEDSIZE=276000
    ;;
esac
[ "$REVERSI_EXTDEPS_SIZE" -le "$REVERSI_EXTDEPS_EXPECTEDSIZE" ] && \
  [ "$REVERSI_SELF_SIZE" -le "$REVERSI_SELF_EXPECTEDSIZE" ] && \
  [ "$REVERSI_OPT_SIZE" -le "$REVERSI_OPT_EXPECTEDSIZE" ]
